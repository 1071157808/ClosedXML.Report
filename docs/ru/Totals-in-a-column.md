---
title: Итоги по столбцам
---

# Итоги по столбцам

Для того, что бы получить итоги по столбцу в ClosedXML.Report имеются агрегационные тэги:

* SUM – отобразит сумму по столбцу;
* AVG или AVERAGE – среднее значение по столбцу;
* COUNT – количество значений в столбцу;
* COUNTNUMS – количество не пустых значений в столбце;
* MAX – максимальное значение в столбце;
* MIN – минимальное значение в столбце;
* PRODUCT - произведение по столбце;
* STDEV - стандартное отклонение;
* STDEVP - стандартное отклонение по генеральной совокупности
* VAR – дисперсия;
* VARP - дисперсия для генеральной совокупности.

Для расчёта итогов ClosedXML.Report использует средства Excel, т.е. каждый из этих тегов будет заменён на соответствующую формулу Excel. К примеру, что бы вычислить сумму Amount paid нам нужно добавить в строку опций тэг `<<sum>>`.

![tlists1_sum](https://user-images.githubusercontent.com/1150085/41203072-128c9404-6cdb-11e8-9126-3957ddfccb10.png)

Каждый агрегационный тэг имеет параметр `over` предоставляющий вам мощное средство, позволяющее выполнять более сложные вычисления, которые по разным причинам не может делать Excel. В частности Excel не сможет посчитать сумму по сложной(многострочной) области. Аргументом параметра over является выражение. Пример:

![tlists4_complexrange_tpl](https://user-images.githubusercontent.com/1150085/41203364-6e9ff36e-6cde-11e8-8551-671c787f7a10.png)

```
<<sum over="item.Amount paid">>
```

Эта функция является очень полезной и для вычислений подитогов в master-detail отчётах. Пример вы можете посмотреть в разделе [Примеры отчётов](Examples#Вложенные-области-с-итогами)
