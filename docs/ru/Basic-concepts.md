---
title: Базовые сущности
---

# Базовые сущности

### Шаблоны
Все работы по созданию отчета основаны на шаблонах (XLSX-шаблоны) - книги Excel, содержащей описание формы отчета, а также опций для книг, листов и областей отчетов. Специальные формулы полей и области данных описывают данные в структуре отчета, которые вы хотите перенести в Excel. ClosedXML.Report вызовет шаблон и заполнит ячейки отчета данными из указанных наборов.

### Переменные
Значения, переданные в ClosedXML.Report с помощью метода `AddVariable`, называются переменными. Они используются для вычисления выражений, используемых в шаблонах. Переменные могут быть добавлены с именем или без него. Если переменная была добавлена без имени, то все общедоступные поля и свойства этого экземпляра будут добавлены как переменные с их именами. 

Примеры:

`template.AddVariable(cust);` 

или

`template.AddVariable("Customer", cust);`. 


### Выражения 
Выражения заключаются в двойные фигурные скобки {% raw %}`{{}}`{% endraw %}. Используется синтаксис, аналогичный C#. Поддерживаются лямбда-выражения.

Примеры: 

{% raw %}
`{{item.Product.Price * item.Product.Quantity}}`

`{{items.Where(i => i.Currency == "RUB").Count()}}`
{% endraw %}

### Тэги
ClosedXML.Report имеет ряд встроенных возможностей, которые позволяют спрятать лист, отсортировать полученную область, получить итоги по ее колонкам, сгруппировать область и др. Эти дополнительные действия можно вызвать, дополнив книгу-шаблон тэгами книги, листа, области или столбцов. Тэг – это строковое значение, заключённое в двойные угловые скобки и понятное анализатору ClosedXML.Report. Эти опции помогут вам получить промежуточные итоги, включить автофильтр, создать сводные таблицы по области и др. Теги могут иметь параметры.

Пример: `<<Range horizontal>>`.

### Области
Для представления значений IEnumerable используются именованные области Excel. Подробнее см. раздел [Плоские таблицы](Flat-tables)
